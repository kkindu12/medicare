<!-- Include Navbar -->
 

<!-- Main Dashboard Content -->
<div class="container-fluid py-4">
  <div class="container">
    <!-- Welcome Section -->
    <div class="row mb-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm bg-light">
          <div class="card-body p-4">
            <div class="row align-items-center">
              <div class="col-md-8">
                <h2 class="card-title mb-2 fw-bold text-dark">Welcome back, Reception!</h2>
                <p class="card-text mb-0 text-muted">
                  <i class="bi bi-calendar-check me-2"></i>
                  Manage appointments, patients, and billing efficiently
                  <span class="ms-3">
                    <i class="bi bi-people me-2"></i>
                    Patient registration and management
                  </span>
                </p>
              </div>
              <div class="col-md-4 text-md-end">
                <div class="d-flex justify-content-md-end justify-content-start gap-2 mt-3 mt-md-0">
                  <button class="btn btn-primary btn-sm">
                    <i class="bi bi-calendar-plus me-1"></i>Quick Actions
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Stats Cards -->
    <div class="row mb-4 justify-content-center">
      <!-- Today Appointment box removed -->
      <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
        <div class="card border-0 shadow-sm h-100 dashboard-card stats-card">
          <div class="card-body text-center py-4">
            <div class="bg-primary bg-opacity-10 p-3 rounded-circle d-inline-block mb-3">
              <i class="bi bi-calendar-event text-primary fs-5"></i>
            </div>
            <div *ngIf="todayAppointments.length > 0" class="fs-3 fw-bold mb-1 text-dark">{{todayAppointments.length}}</div>
            <h5 class="card-title fw-bold mb-1">Today Appointments</h5>
            <!-- Only showing today appointments and its quantity above the label -->
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
        <div class="card border-0 shadow-sm h-100 dashboard-card stats-card">
          <div class="card-body text-center py-4">
            <div class="bg-success bg-opacity-10 p-3 rounded-circle d-inline-block mb-3">
              <i class="bi bi-person-plus text-success fs-5"></i>
            </div>
            <h5 class="card-title fw-bold mb-1">Patient Registration</h5>
            <p class="card-text text-muted small mb-3">Add New Patients</p>
            <button class="btn btn-success btn-sm w-100" (click)="addNewPatient()">Add New Patient</button>
          </div>
        </div>
      </div>

      <!-- Add New Patient Form -->
      <div *ngIf="showAddPatientForm" class="col-12 mb-4">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <h5 class="fw-bold mb-3">Register New Patient</h5>
            <form (ngSubmit)="submitNewPatient()" #patientForm="ngForm" autocomplete="off">
              <div class="row mb-2">
                <div class="col-md-6 mb-2">
                  <label class="form-label small">First Name *</label>
                  <input type="text" class="form-control" [(ngModel)]="patientFirstName" name="firstName" required>
                </div>
                <div class="col-md-6 mb-2">
                  <label class="form-label small">Last Name *</label>
                  <input type="text" class="form-control" [(ngModel)]="patientLastName" name="lastName" required>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-6 mb-2">
                  <label class="form-label small">Email *</label>
                  <input type="email" class="form-control" [(ngModel)]="patientEmail" name="email" required>
                </div>
                <div class="col-md-6 mb-2">
                  <label class="form-label small">Phone Number *</label>
                  <input type="tel" class="form-control" [(ngModel)]="patientPhoneNumber" name="phoneNumber" required>
                </div>
              </div>
              <div class="row mb-2">
                <div class="col-md-6 mb-2">
                  <label class="form-label small">Date of Birth *</label>
                  <input type="date" class="form-control" [(ngModel)]="patientDOB" name="dob" required>
                </div>
                <div class="col-md-6 mb-2">
                  <label class="form-label small">Gender *</label>
                  <select class="form-select" [(ngModel)]="patientGender" name="gender" required>
                    <option value="">Select</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                  </select>
                </div>
              </div>
              <div class="mb-2">
                <label class="form-label small">Address</label>
                <input type="text" class="form-control" [(ngModel)]="patientAddress" name="address">
              </div>
              <div *ngIf="patientError" class="alert alert-danger py-2">{{ patientError }}</div>
              <div class="d-flex gap-2 mt-3">
                <button type="submit" class="btn btn-success">Register</button>
                <button type="button" class="btn btn-secondary" (click)="cancelAddPatient()">Cancel</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
        <div class="card border-0 shadow-sm h-100 dashboard-card stats-card">
          <div class="card-body text-center py-4">
            <div class="bg-info bg-opacity-10 p-3 rounded-circle d-inline-block mb-3">
              <i class="bi bi-clock text-info fs-5"></i>
            </div>
            <div *ngIf="availableDoctors.length > 0" class="fs-3 fw-bold mb-1 text-dark">{{availableDoctors.length}}</div>
            <h5 class="card-title fw-bold mb-1">Available Doctors</h5>
            <!-- Only showing available doctors and its quantity above the label -->
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-md-6 col-sm-6 mb-3">
        <div class="card border-0 shadow-sm h-100 dashboard-card stats-card">
          <div class="card-body text-center py-4">
            <div class="bg-warning bg-opacity-10 p-3 rounded-circle d-inline-block mb-3">
              <i class="bi bi-receipt text-warning fs-5"></i>
            </div>
            <h5 class="card-title fw-bold mb-1">Create Bill</h5>
            <p class="card-text text-muted small mb-3">Generate Invoices</p>
            <button class="btn btn-warning btn-sm w-100" (click)="generateBill()">Generate Bill</button>
          </div>
        </div>
      </div>

    <!-- Dashboard Tabs -->
    <ul class="nav nav-tabs mb-4" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="appointment-tab" data-bs-toggle="tab" data-bs-target="#appointment" type="button" role="tab" aria-controls="appointment" aria-selected="true">Appointment</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="patient-tab" data-bs-toggle="tab" data-bs-target="#patient" type="button" role="tab" aria-controls="patient" aria-selected="false">Patient</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="doctor-tab" data-bs-toggle="tab" data-bs-target="#doctor" type="button" role="tab" aria-controls="doctor" aria-selected="false">Doctor</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="payment-tab" data-bs-toggle="tab" data-bs-target="#payment" type="button" role="tab" aria-controls="payment" aria-selected="false">Payment</button>
      </li>
    </ul>
    <div class="tab-content mb-4">
      <div class="tab-pane fade show active" id="appointment" role="tabpanel" aria-labelledby="appointment-tab">
        <!-- Appointment tab with filter button for Today and All -->
        <div class="d-flex justify-content-end mb-3">
          <div class="btn-group" role="group" aria-label="Filter appointments">
            <button type="button" class="btn btn-outline-primary" [class.active]="appointmentFilter === 'today'" (click)="appointmentFilter = 'today'">Today</button>
            <button type="button" class="btn btn-outline-primary" [class.active]="appointmentFilter === 'all'" (click)="appointmentFilter = 'all'">All</button>
          </div>
        </div>
        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h5 class="fw-bold mb-3">{{ appointmentFilter === 'today' ? "Today's Appointments" : 'All Appointments' }}</h5>
            <div *ngIf="(appointmentFilter === 'today' ? todayAppointments : allAppointments).length > 0; else noAppointments">
              <div class="row">
                <div class="col-md-4 mb-3" *ngFor="let appointment of (appointmentFilter === 'today' ? todayAppointments : allAppointments)">
                  <div class="card h-100">
                    <div class="card-body">
                      <h6 class="fw-bold mb-1">{{appointment.doctorName}}</h6>
                      <p class="mb-1 text-muted">{{appointment.doctorSpecialty}}</p>
                      <p class="mb-1"><i class="bi bi-calendar me-1"></i>{{appointment.date}}</p>
                      <p class="mb-1"><i class="bi bi-clock me-1"></i>{{appointment.time}}</p>
                      <p class="mb-1"><i class="bi bi-person me-1"></i>{{appointment.reason}}</p>
                      <span class="badge bg-primary">{{appointment.status}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <ng-template #noAppointments>
              <div class="text-center text-muted py-4">
                <i class="bi bi-calendar-x fs-2"></i>
                <h6>No appointments found.</h6>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="patient" role="tabpanel" aria-labelledby="patient-tab">
        <!-- Patient tab content placeholder -->
      </div>
      <div class="tab-pane fade" id="doctor" role="tabpanel" aria-labelledby="doctor-tab">
        <!-- Doctor tab with filter button for Available and All -->
        <div class="d-flex justify-content-end mb-3">
          <div class="btn-group" role="group" aria-label="Filter doctors">
            <button type="button" class="btn btn-outline-primary" [class.active]="doctorFilter === 'available'" (click)="doctorFilter = 'available'">Available</button>
            <button type="button" class="btn btn-outline-primary" [class.active]="doctorFilter === 'all'" (click)="doctorFilter = 'all'">All</button>
          </div>
        </div>
        <div class="card border-0 shadow-sm mb-4">
          <div class="card-body">
            <h5 class="fw-bold mb-3">{{ doctorFilter === 'available' ? 'Available Doctors' : 'All Doctors' }}</h5>
            <div *ngIf="(doctorFilter === 'available' ? availableDoctors : allDoctors).length > 0; else noDoctorsTab">
              <div class="row">
                <div class="col-md-4 mb-3" *ngFor="let doctor of (doctorFilter === 'available' ? availableDoctors : allDoctors)">
                  <div class="card h-100">
                    <div class="card-body">
                      <h6 class="fw-bold mb-1">{{doctor.name}}</h6>
                      <p class="mb-1 text-muted">{{doctor.specialty}}</p>
                      <p class="mb-1"><i class="bi bi-clock me-1"></i>{{doctor.availableTime}}</p>
                      <span class="badge bg-success" *ngIf="doctorFilter === 'available' || doctor.available">Available</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <ng-template #noDoctorsTab>
              <div class="text-center text-muted py-4">
                <i class="bi bi-person-x fs-2"></i>
                <h6>No doctors found.</h6>
              </div>
            </ng-template>
          </div>
        </div>
      </div>
      <div class="tab-pane fade" id="payment" role="tabpanel" aria-labelledby="payment-tab">
        <!-- Payment tab content placeholder -->
      </div>
    </div>


    <!-- Doctor Availability Section -->
    <div *ngIf="showDoctorAvailability" class="col-12 mt-3">
      <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
          <h5 class="fw-bold mb-3">Available Doctors</h5>
          <div *ngIf="availableDoctors.length > 0; else noDoctors">
            <div class="row">
              <div class="col-md-4 mb-3" *ngFor="let doctor of availableDoctors">
                <div class="card h-100">
                  <div class="card-body">
                    <h6 class="fw-bold mb-1">{{doctor.name}}</h6>
                    <p class="mb-1 text-muted">{{doctor.specialty}}</p>
                    <p class="mb-1"><i class="bi bi-clock me-1"></i>{{doctor.availableTime}}</p>
                    <span class="badge bg-success">Available</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noDoctors>
            <div class="text-center text-muted py-4">
              <i class="bi bi-person-x fs-2"></i>
              <h6>No doctors available at this time.</h6>
            </div>
          </ng-template>
        </div>
      </div>
    </div>
  </div>
</div>