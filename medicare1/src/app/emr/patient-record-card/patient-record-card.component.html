<div class="card p-3">
  <div class="d-flex justify-content-between align-items-start">
    <h5 class="card-title">{{ record.user?.firstName }} {{ record.user?.lastName }}</h5>
    <div *ngIf="record.isEdited" class="edited-indicator">
      <small class="badge bg-info text-dark">
        <i class="bi bi-pencil-square"></i> Edited
      </small>
    </div>
  </div>
  <p class="card-text text-muted">
    Condition: {{ record.condition }}<br>
    Email: {{ record.user?.email }}<br>
    Last Visit: {{ record.visitDate }} at {{ record.visitTime }}<br>
    Status: <span class="badge" [ngClass]="{'bg-success': record.status === 'Stable', 'bg-warning': record.status === 'Critical'}">{{ record.status }}</span>
      <!-- Doctor Information -->
    <span class="d-block mt-2">
      <small class="text-primary">
        <i class="bi bi-person-badge"></i> 
        <strong>Treating Doctor:</strong> 
        <span *ngIf="record.doctorUser; else doctorNameOnly">
          Dr. {{ record.doctorUser.firstName }} {{ record.doctorUser.lastName }}
          <br><small class="text-muted">{{ record.doctorUser.email }}</small>
        </span>
        <ng-template #doctorNameOnly>
          {{ record.doctor }}
        </ng-template>
      </small>
    </span>
    
    <span *ngIf="record.isEdited && record.editedByName" class="d-block mt-1">
      <small class="text-info">
        <i class="bi bi-person-check"></i> Edited by: {{ record.editedByName }}
      </small>
    </span>
  </p>
  <div class="d-flex justify-content-between">
    <div class="d-flex gap-2">
      <button class="btn btn-outline-primary btn-sm" (click)="onEditRecord()">
        <i class="bi bi-pencil"></i> Edit
      </button>
      <button class="btn btn-outline-primary btn-sm" (click)="onAddReport()">
        <i class="bi bi-file-earmark-arrow-up"></i> Add Report
      </button>
    </div>
    <button class="btn btn-outline-primary btn-sm" (click)="onViewHistory()">
      <i class="bi bi-clock-history"></i> View History
    </button>
  </div>
</div>
