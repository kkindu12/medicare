<div class="pharmacy-container">
  <div class="search-container">
    <input type="text" class="search-bar" placeholder="Search by medicine name, category, or code..." (input)="filterMedicines($event)">
    
    <div class="filter-row">
      <div class="filter-group">
        <label for="category">Category:</label>
        <select id="category" class="filter-select" (change)="filterByCategory($event)">
          <option value="">All Categories</option>
          <option value="antibiotics">Antibiotics</option>
          <option value="analgesics">Analgesics</option>
          <option value="antidiabetics">Antidiabetics</option>
          <option value="cardiovascular">Cardiovascular</option>
          <option value="vitamins">Vitamins & Supplements</option>
            <option value="antihypertensives">Antihypertensives</option>
            <option value="antihistamines">Antihistamines</option>
            <option value="thyroid">Thyroid Medications</option>
            <option value="cardiovascular">Cardiovascular</option>
            <option value=" anti-inflammatory"> Anti-inflammatory</option>
            <option value="antacids">Antacids</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="availability">Availability:</label>
        <select id="availability" class="filter-select" (change)="filterByAvailability($event)">
          <option value="">All Items</option>
          <option value="in-stock">In Stock</option>
          <option value="low-stock">Low Stock</option>
          <option value="out-of-stock">Out of Stock</option>
        </select>
      </div>
      
      <div class="filter-group">
        <label for="manufacturer">Manufacturer:</label>
        <select id="manufacturer" class="filter-select" (change)="filterByManufacturer($event)">
          <option value="">All Manufacturers</option>
          <option value="gsk">GSK</option>
          <option value="pfizer">Pfizer</option>
          <option value="novartis">Novartis</option>
          <option value="bayer">Bayer</option>
          <option value="roche">Roche</option>
            <option value="sanofi">Sanofi</option>
            <option value="merck">Merck</option>
            <option value="abbvie">AbbVie</option>
        </select>
      </div>
    </div>
    
    <button class="clear-btn" (click)="clearFilters()">Clear Filters</button>
  </div>
  
  <h2 class="section-title">Available Medicines ({{ filteredMedicines.length }})</h2>
  
  <div class="tabs">
    <div class="tab" [class.active]="activeTab === 'all-medicines'" data-target="all-medicines" (click)="switchTab('all-medicines')">All Medicines</div>
    <div class="tab" [class.active]="activeTab === 'prescriptions'" data-target="prescriptions" (click)="switchTab('prescriptions')">Prescriptions</div>
    <div class="tab" [class.active]="activeTab === 'recent'" data-target="recent" (click)="switchTab('recent')">Recently Added</div>
    <div class="tab" [class.active]="activeTab === 'expiring'" data-target="expiring" (click)="switchTab('expiring')">Expiring Soon</div>
  </div>
  
  <div class="card-container">
    <div class="card" *ngFor="let medicine of filteredMedicines">
      <span class="status" [ngClass]="getStatusClass(medicine.status)">{{ medicine.status }} ({{ medicine.stock }})</span>
      <h3>{{ medicine.name }}</h3>
      <p>Category: {{ medicine.category }}</p>
      <p>Manufacturer: {{ medicine.manufacturer }}</p>
      <p>Expires: {{ medicine.expires }}</p>
      <p>Price: ${{ medicine.price.toFixed(2) }}</p>
      <button class="btn btn-primary" (click)="openOrderModal(medicine.name)">Order</button>
    </div>
  </div>
</div>

<!-- Order Medicine Modal -->
<div id="orderModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Order Medicine</h2>
      <button class="close-btn" (click)="closeModal('orderModal')">&times;</button>
    </div>
    
    <form (ngSubmit)="submitOrder()" #orderForm="ngForm">
      <div class="form-group">
        <label for="medicineName">Medicine:</label>
        <input type="text" id="medicineName" class="form-control" [(ngModel)]="selectedOrder.medicineName" name="medicineName" readonly>
      </div>
      
      <div class="form-group">
        <label for="quantity">Quantity:</label>
        <input type="number" id="quantity" class="form-control" min="1" [(ngModel)]="selectedOrder.quantity" name="quantity" required>
      </div>
      
      <div class="form-group">
        <label for="patientId">Patient ID:</label>
        <input type="text" id="patientId" class="form-control" [(ngModel)]="selectedOrder.patientId" name="patientId" required>
      </div>
        <div class="form-group">
        <label for="prescriptionId">Prescription ID (if applicable):</label>
        <input type="text" id="prescriptionId" class="form-control" [(ngModel)]="selectedOrder.prescriptionId" name="prescriptionId">
      </div>

      <div class="form-group">
        <label for="prescriptionReceipt">Upload Prescription Receipt:</label>
        <div class="file-upload-container">
          <input type="file" id="prescriptionReceipt" class="file-input" 
                 accept=".pdf,.jpg,.jpeg,.png,.gif" 
                 (change)="onFileSelected($event)" 
                 #fileInput>
          <label for="prescriptionReceipt" class="file-upload-label">
            <i class="upload-icon">ðŸ“Ž</i>
            <span>{{ selectedFile ? selectedFile.name : 'Choose file or drag here' }}</span>
          </label>
          <div class="file-info" *ngIf="selectedFile">
            <small>{{ selectedFile.name }} ({{ formatFileSize(selectedFile.size) }})</small>
            <button type="button" class="remove-file-btn" (click)="removeFile()">&times;</button>
          </div>
        </div>
        <small class="form-text">Accepted formats: PDF, JPG, JPEG, PNG, GIF (Max 5MB)</small>
      </div>
  
       <div class="form-group">
        <label for="address">Courier Address:</label>
        <textarea id="address" class="form-control" [(ngModel)]="selectedOrder.address" name="address"></textarea>
      </div>


      <div class="form-group">
        <label for="notes">Notes:</label>
        <textarea id="notes" class="form-control" [(ngModel)]="selectedOrder.notes" name="notes"></textarea>
        </div>
      
      <div class="btn-group">
        <button type="button" class="btn btn-outline" (click)="closeModal('orderModal')">Cancel</button>
        <button type="submit" class="btn btn-primary" [disabled]="!orderForm.form.valid">Confirm Order</button>
      </div>
    </form>
  </div>
</div>
