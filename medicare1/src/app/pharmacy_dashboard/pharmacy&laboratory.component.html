<div class="pharmacy-dashboard">
  <!-- Header -->
  <div class="header">
    <div class="logo-section">
      <div class="logo-icon">ğŸ’Š</div>
      <h1>Pharmacy & Laboratory</h1>
    </div>
    <div class="user-section">
      
      <div class="user-info">
        <div class="user-avatar">ğŸ‘¤</div>
        <span class="user-name">Dr. Pharmacy</span>
        
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Welcome Section -->
    <div class="welcome-section">
      <div class="welcome-header">
        <div class="welcome-text">
          <h2>Welcome !</h2>
          
        </div>
      </div>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-container">
      <div class="stat-card yellow">
        <div class="stat-icon">ğŸ“‹</div>
        <div class="stat-number">{{ pharmacyStats.pendingPrescriptions }}</div>
        <div class="stat-label">Pending Prescriptions</div>
      </div>
      <div class="stat-card blue">
        <div class="stat-icon">ğŸ§ª</div>
        <div class="stat-number">{{ pharmacyStats.labTestRequests }}</div>
        <div class="stat-label">Lab Test Requests</div>
      </div>
      <div class="stat-card red">
        <div class="stat-icon">ğŸ“¦</div>
        <div class="stat-number">{{ pharmacyStats.lowStockItems }}</div>
        <div class="stat-label">Low Stock Items</div>
      </div>
    </div>

    <!-- Tab Navigation -->
    <div class="tab-navigation">
      <button 
        class="tab-button" 
        [class.active]="isActiveTab('prescriptions')"
        (click)="setActiveTab('prescriptions')">
        <span class="tab-icon">ğŸ’Š</span>
        Prescriptions
      </button>
      <button 
        class="tab-button" 
        [class.active]="isActiveTab('lab-tests')"
        (click)="setActiveTab('lab-tests')">
        <span class="tab-icon">ğŸ§ª</span>
        Lab Tests
      </button>
      <button 
        class="tab-button" 
        [class.active]="isActiveTab('inventory')"
        (click)="setActiveTab('inventory')">
        <span class="tab-icon">ğŸ“¦</span>
        Inventory
      </button>
    </div>

    <!-- Search and Filter Controls -->
    <div class="controls-section">
      <div class="search-box">
        <input 
          type="text" 
          placeholder="Search..." 
          [(ngModel)]="searchTerm"
          (input)="onSearchChange(searchTerm)">
        <span class="search-icon">ğŸ”</span>
      </div>
      <div class="filter-dropdown">
        <select [(ngModel)]="selectedStatus" (change)="onStatusFilterChange(selectedStatus)">
          <option value="ALL">All Status</option>
          <option value="PENDING">Pending</option>
          <option value="URGENT">Urgent</option>
          <option value="COMPLETED">Completed</option>
          <option value="CANCELLED">Cancelled</option>
        </select>
      </div>
      <button class="btn btn-clear" (click)="clearFilters()">
        <span class="btn-icon">ğŸ—‘ï¸</span>
        Clear Filters
      </button>
    </div>

    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Prescriptions Tab -->
      <div class="prescriptions-section" *ngIf="isActiveTab('prescriptions')">        <div class="section-header">
          <h3>Prescription Management</h3>
          <button class="btn btn-primary" (click)="addNewPrescription()">
            <span class="btn-icon">ğŸ’Š</span>
            New Prescription
          </button>
        </div>

        <div class="prescriptions-grid" *ngIf="filteredPrescriptions.length > 0">
          <div class="prescription-card" *ngFor="let prescription of filteredPrescriptions">
            <div class="card-header">
              <h4>{{ prescription.patientName }}</h4>
              <span class="status-badge" [ngClass]="prescription.status.toLowerCase()">
                {{ prescription.status }}
              </span>
            </div>
            <div class="card-body">
              <p><strong>Patient ID:</strong> {{ prescription.patientId }}</p>
              <p><strong>Medication:</strong> {{ prescription.medication }}</p>
              <p><strong>Doctor:</strong> {{ prescription.doctor }}</p>
              <p><strong>Dosage:</strong> {{ prescription.dosage }}</p>
              <p><strong>Frequency:</strong> {{ prescription.frequency }}</p>
              <p><strong>Duration:</strong> {{ prescription.duration }}</p>
              <p><strong>Date:</strong> {{ prescription.date }} at {{ prescription.time }}</p>
              <p *ngIf="prescription.notes"><strong>Notes:</strong> {{ prescription.notes }}</p>
            </div>            <div class="card-actions">
              <button class="btn btn-view" (click)="viewPrescriptionDetails(prescription)" 
                      onclick="console.log('View button clicked directly')">
                <span class="btn-icon">ğŸ‘ï¸</span>
                View
              </button>
              <button class="btn btn-edit" (click)="editPrescription(prescription)"
                      onclick="console.log('Edit button clicked directly')">
                <span class="btn-icon">âœï¸</span>
                Edit
              </button>
              <button class="btn btn-status" (click)="updatePrescriptionStatus(prescription.id!, 'COMPLETED')">
                <span class="btn-icon">âœ…</span>
                Mark Complete
              </button>
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="filteredPrescriptions.length === 0">
          <div class="empty-icon">ğŸ“‹</div>
          <h3>No prescriptions found</h3>
          <p *ngIf="searchTerm || selectedStatus !== 'ALL'">
            Try adjusting your search or filter criteria.
          </p>
          <p *ngIf="!searchTerm && selectedStatus === 'ALL'">
            No prescriptions available at the moment.
          </p>
        </div>
      </div>      <!-- Lab Tests Tab -->
      <div class="lab-tests-section" *ngIf="isActiveTab('lab-tests')">
        <div class="section-header">
          <h3>Laboratory Tests</h3>
          <button class="btn btn-primary" (click)="addNewLabTest()">
            <span class="btn-icon">ğŸ§ª</span>
            New Lab Test
          </button>
        </div>        <div class="prescriptions-grid" *ngIf="filteredLabTests.length > 0">
          <div class="prescription-card" *ngFor="let test of filteredLabTests">
            <div class="card-header">
              <h4>{{ test.testName }}</h4>
              <span class="status-badge" [ngClass]="test.priority.toLowerCase()">
                {{ test.priority }}
              </span>
            </div>
            <div class="card-body">
              <p><strong>Patient ID:</strong> {{ test.patientId }}</p>
              <p><strong>Patient:</strong> {{ test.patientName }}</p>
              <p><strong>Doctor:</strong> {{ test.doctor }}</p>
              <p><strong>Priority:</strong> {{ test.priority }}</p>
              <p><strong>Status:</strong> {{ test.status }}</p>
              <p><strong>Request Date:</strong> {{ test.requestDate }}</p>
              <p *ngIf="test.expectedDate"><strong>Expected Date:</strong> {{ test.expectedDate }}</p>
              <p *ngIf="test.notes"><strong>Notes:</strong> {{ test.notes }}</p>
            </div>
            <div class="card-actions">
              <button class="btn btn-view" (click)="viewLabTestDetails(test)">
                <span class="btn-icon">ğŸ‘ï¸</span>
                View
              </button>
              <button class="btn btn-edit" (click)="editLabTest(test)">
                <span class="btn-icon">âœï¸</span>
                Edit
              </button>
              <button class="btn btn-status" (click)="startLabTest(test.id)" *ngIf="test.status === 'PENDING'">
                <span class="btn-icon">âœ…</span>
                Mark Complete
              </button>
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="filteredLabTests.length === 0">
          <div class="empty-icon">ğŸ§ª</div>
          <h3>No lab tests found</h3>
          <p *ngIf="searchTerm || selectedStatus !== 'ALL'">
            Try adjusting your search or filter criteria.
          </p>
          <p *ngIf="!searchTerm && selectedStatus === 'ALL'">
            No lab tests scheduled at the moment.
          </p>
        </div>
      </div>

      <!-- Inventory Tab -->
      <div class="inventory-section" *ngIf="isActiveTab('inventory')">        <div class="section-header">
          <h3>Inventory Management</h3>
          <button class="btn btn-primary" (click)="addNewInventoryItem()">
            <span class="btn-icon">ğŸ“¦</span>
            Add Item
          </button>
        </div>

        <div class="inventory-grid" *ngIf="filteredInventory.length > 0">
          <div class="inventory-card" *ngFor="let item of filteredInventory">
            <div class="card-header">
              <h4>{{ item.name }}</h4>
              <span class="stock-badge" [ngClass]="item.status.toLowerCase().replace('_', '-')">
                {{ item.status.replace('_', ' ') }}
              </span>
            </div>
            <div class="card-body">
              <p><strong>Category:</strong> {{ item.category }}</p>
              <p><strong>Current Stock:</strong> {{ item.currentStock }} units</p>
              <p><strong>Minimum Stock:</strong> {{ item.minimumStock }} units</p>
              <p><strong>Unit Price:</strong> ${{ item.unitPrice }}</p>
              <p><strong>Expiry Date:</strong> {{ item.expiryDate }}</p>
              <p><strong>Batch Number:</strong> {{ item.batchNumber }}</p>
              <p><strong>Supplier:</strong> {{ item.supplier }}</p>
            </div>            <div class="card-actions">
              <button class="btn btn-view" (click)="viewInventoryItemDetails(item)">
                <span class="btn-icon">ğŸ‘ï¸</span>
                View
              </button>
              <button class="btn btn-edit" (click)="editInventoryItem(item)">
                <span class="btn-icon">âœï¸</span>
                Edit
              </button>
              <button class="btn btn-restock" (click)="restockItem(item.id)" *ngIf="item.status === 'LOW_STOCK' || item.status === 'OUT_OF_STOCK'">
                <span class="btn-icon">ğŸ”„</span>
                Restock
              </button>
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="filteredInventory.length === 0">
          <div class="empty-icon">ğŸ“¦</div>
          <h3>No inventory items found</h3>
          <p *ngIf="searchTerm || selectedStatus !== 'ALL'">
            Try adjusting your search or filter criteria.
          </p>
          <p *ngIf="!searchTerm && selectedStatus === 'ALL'">
            No inventory items available at the moment.
          </p>
        </div>
      </div>

      <!-- Prescription Details Modal -->  <app-prescription-modal
    [isOpen]="isModalVisible"
    [modalType]="modalType"
    [mode]="modalMode"
    [data]="selectedPrescription || selectedLabTest || selectedInventoryItem"
    (close)="closeModal()"
    (save)="onSaveFromModal($event)">
  </app-prescription-modal>

  <style>
.report-section {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
}

.report-card {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 1rem;
  width: 300px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.report-card h3 {
  margin: 0;
  font-size: 1.2rem;
}

.badge {
  display: inline-block;
  padding: 0.2rem 0.5rem;
  border-radius: 4px;
  font-size: 0.8rem;
  color: #fff;
}

.badge.daily {
  background-color: #007bff;
}

.badge.weekly {
  background-color: #28a745;
}

.badge.monthly {
  background-color: #ffc107;
}

.badge.annual {
  background-color: #dc3545;
}

.actions {
  display: flex;
  justify-content: space-between;
  margin-top: 1rem;
}

.actions button {
  background-color: #007bff;
  color: #fff;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 4px;
  cursor: pointer;
}

.actions button:hover {
  background-color: #0056b3;
}

.modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: #fff;
  padding: 2rem;
  border-radius: 8px;
  width: 400px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.modal-content h3 {
  margin-top: 0;
}

.modal-content label {
  display: block;
  margin: 0.5rem 0 0.2rem;
}

.modal-content input,
.modal-content select {
  width: 100%;
  padding: 0.5rem;
  margin-bottom: 1rem;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.modal-content button {
  margin-right: 0.5rem;
  padding: 0.5rem 1rem;
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.modal-content button:first-child {
  background-color: #28a745;
  color: #fff;
}

.modal-content button:last-child {
  background-color: #dc3545;
  color: #fff;
}
</style>
</div>
