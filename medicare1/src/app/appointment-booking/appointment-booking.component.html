<app-navbar></app-navbar>

<div class="container py-4">
  <h1 class="text-primary mb-4">Appointment Management</h1>

  <!-- Action Buttons -->
  <div class="mb-4">
    <button class="btn btn-primary me-3" routerLink="/find-doctor">Find Doctor</button>
    <button class="btn btn-outline-primary" routerLink="/my-appointments">My Appointments</button>
  </div>

  <!-- Search Description -->
  <p class="mb-4">Find a doctor and book your appointment today.</p>

  <!-- Search Bar -->
  <div class="mb-4">
    <input 
      type="text" 
      class="form-control" 
      placeholder="Search by doctor name, specialty, or location..."
      [(ngModel)]="searchQuery"
      (input)="searchDoctors()"
    >
  </div>

  <!-- Filters -->
  <div class="row mb-3">
    <div class="col-md-4">
      <div class="mb-2">Specialty:</div>
      <div class="dropdown">
        <select class="form-select" [(ngModel)]="selectedSpecialty" (change)="searchDoctors()">
          <option value="">All Specialties</option>
          <option *ngFor="let specialty of specialties" [value]="specialty">
            {{specialty}}
          </option>
        </select>
      </div>
    </div>

    <div class="col-md-4">
      <div class="mb-2">Location:</div>
      <div class="dropdown">
        <select class="form-select" [(ngModel)]="selectedLocation" (change)="searchDoctors()">
          <option value="">All Locations</option>
          <option *ngFor="let location of locations" [value]="location">
            {{location}}
          </option>
        </select>
      </div>
    </div>

    <div class="col-md-4">
      <div class="mb-2">Time Slot:</div>
      <div class="dropdown">
        <select class="form-select" [(ngModel)]="selectedTimeSlot" (change)="searchDoctors()">
          <option value="">All Time Slots</option>
          <option *ngFor="let slot of timeSlots" [value]="slot">
            {{slot}}
          </option>
        </select>
      </div>
    </div>
  </div>

  <!-- Clear Filters -->
  <button class="btn btn-link text-decoration-none mb-4 p-0" (click)="clearFilters()">
    Clear Filters
  </button>

  <!-- Available Doctors -->
  <div class="row">
    <div class="col-md-12">
      <div class="results-header">
        <h3>Available Doctors</h3>
        <button class="btn btn-outline-primary" (click)="toggleShowAll()">
          {{ showAllResults ? 'Show Less' : 'Show All' }}
        </button>
      </div>
      <div *ngIf="searchResults.length > 0" class="doctors-list">
        <div *ngFor="let doctor of searchResults" class="doctor-card">
          <div class="card h-100">
            <div class="card-body">
              <h3 class="h5 mb-2">{{doctor.name}}</h3>
              <p class="mb-1">
                <a href="#" class="text-primary text-decoration-none">{{doctor.specialty}}</a>
              </p>
              <p class="text-muted mb-2">{{doctor.location}}</p>
              <p class="mb-2">
                Rating: {{doctor.rating}} 
                <i class="bi bi-star-fill text-warning"></i>
              </p>
              <p class="mb-3">Experience: {{doctor.experience}} years</p>

              <div class="mt-3">
                <h4 class="h6 mb-2">Available Time Slots:</h4>
                <div class="d-flex flex-wrap gap-2">
                  <button 
                    *ngFor="let slot of doctor.availableSlots"
                    class="btn btn-outline-primary btn-sm"
                    (click)="bookAppointment(doctor, slot)"
                  >
                    {{slot}}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="searchResults.length === 0" class="no-results">
        <p>No doctors found matching your criteria.</p>
      </div>
    </div>
  </div>
</div>
